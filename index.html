<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Join</title>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
  <link rel="icon" href="img/logo/Logo for Favicon construction.svg" type="image/svg+xml" />
  <link rel="stylesheet" href="css/fonts.css" />
  <link rel="stylesheet" href="css/indexstyle.css" />
</head>

<body>
  <!-- HEADER -->
  <div id="intro-screen">
    <img src="img/logo/Logo for Favicon construction.svg" alt="Join Logo" />
  </div>

  <header>
    <img src="img/logo/Logo for Favicon construction.svg" alt="Join Logo" class="join-logo" />
    <div class="signup-box" id="signup-top">
      <span class="signup-text">Not a Join user?</span>
      <button class="signup-btn dark-button" id="toggle-form">Sign up</button>
    </div>
  </header>

  <!-- LOGIN FORM -->
  <main id="login-form" class="active">
    <h1>Log in</h1>
    <div class="blueline"></div>
    <form onsubmit="login(); return false;">
      <div class="input-group">
        <input type="email" placeholder="E-Mail" id="login-email" required />
        <img src="img/icons/mail.svg" alt="Mail Icon" class="icon-mail" />
      </div>

      <div class="input-group">
        <input type="password" placeholder="Passwort" id="login-password" required />
        <img src="img/icons/lock.svg" alt="Lock Icon" class="icon-lock" id="toggle-password" />
      </div>

      <div class="button-group">
        <button class="dark-button" type="submit">Log in</button>
        <button type="button" onclick="guestLogin()">Guest Log in</button>
      </div>
    </form>
  </main>

  <!-- SIGN UP FORM -->
  <main id="signup-form" class="hidden">
    <div class="signup-header">
      <span class="material-icons back-arrow" id="back-to-login">arrow_back</span>
      <h1>Sign up</h1>
    </div>
    <div class="blueline"></div>
    <form onsubmit="addUser(); return false;">
      <div class="input-group">
        <input type="text" id="name" placeholder="Name" required />
        <img src="img/icons/person.svg" alt="Person Icon" class="icon-person" />
      </div>

      <div class="input-group">
        <input type="email" id="email" placeholder="E-Mail" required />
        <img src="img/icons/mail.svg" alt="Mail Icon" class="icon-mail" />
      </div>

      <div class="input-group">
        <input type="password" id="signup-password" placeholder="Passwort" required />
        <img src="img/icons/lock.svg" alt="Lock Icon" class="icon-lock" />
      </div>

      <!-- üî• NEU: Confirm Password + Live-Warnung -->
      <div class="input-group">
        <input type="password" id="confirm-password" placeholder="Confirm Passwort" required />
        <img src="img/icons/lock.svg" alt="Confirm Lock Icon" class="icon-lock" />
      </div>
      <span id="password-error" style="color: red; font-size: 14px;"></span>

      <label class="privacy-accept">
        <input type="checkbox" required />
        I accept the
        <a href="privacypolicy.html" target="_blank">Privacy Policy</a>
      </label>

      <div class="button-group">
        <button type="submit" class="dark-button">Sign up</button>
      </div>
    </form>
  </main>


  <!-- SIGNUP-BOX F√úR MOBILE -->
  <div class="signup-box" id="signup-bottom">
    <span class="signup-text">Not a Join user?</span>
    <button class="signup-btn dark-button" id="toggle-form-2">Sign up</button>
  </div>

  <!-- FOOTER -->
  <div class="footer-links">
    <a href="privacypolicy.html">Privacy Policy</a>
    <a href="legal-notice.html">Legal Notice</a>
  </div>

  <!-- SCRIPT -->
  <script>
    const togglePassword = document.getElementById("toggle-password");
    const passwordInput = document.getElementById("password");

    if (togglePassword && passwordInput) {
      togglePassword.addEventListener("click", () => {
        const isPwd = passwordInput.type === "password";
        passwordInput.type = isPwd ? "text" : "password";

        // Optional: Icon tauschen (falls du z. B. eye.svg hast)
        // togglePassword.src = isPwd ? "img/icons/eye-off.svg" : "img/icons/lock.svg";
      });
    }

    const toggleForm = document.getElementById("toggle-form");
    const toggleForm2 = document.getElementById("toggle-form-2");
    const loginForm = document.getElementById("login-form");
    const signupForm = document.getElementById("signup-form");
    const signupTexts = document.querySelectorAll(".signup-text");
    const signupBtns = document.querySelectorAll(".signup-btn");
    const backArrow = document.getElementById("back-to-login");

   function toggleForms() {
  const isLoginVisible = loginForm.classList.contains("active");

  if (isLoginVisible) {
    // ‚Üí Wechsel zu SIGN UP
    loginForm.classList.remove("active");
    loginForm.classList.add("hidden");

    signupForm.classList.remove("hidden");
    signupForm.classList.add("active");

    // Signup-Boxen komplett ausblenden
    signupTexts.forEach((el) => (el.style.display = "none"));
    signupBtns.forEach((el) => (el.style.display = "none"));

  } else {
    // ‚Üí Wechsel zu LOGIN
    signupForm.classList.remove("active");
    signupForm.classList.add("hidden");

    loginForm.classList.remove("hidden");
    loginForm.classList.add("active");

    // Signup-Boxen wieder einblenden
    signupTexts.forEach((el) => (el.style.display = "inline"));
    signupBtns.forEach((el) => (el.style.display = "inline"));
  }
}

    if (toggleForm) toggleForm.addEventListener("click", toggleForms);
    if (toggleForm2) toggleForm2.addEventListener("click", toggleForms);

   if (backArrow) {
  backArrow.addEventListener("click", () => {
    signupForm.classList.remove("active");
    signupForm.classList.add("hidden");

    loginForm.classList.remove("hidden");
    loginForm.classList.add("active");

    // Einblenden der Texte/Buttons
    signupTexts.forEach((el) => (el.style.display = "inline"));
    signupBtns.forEach((el) => (el.style.display = "inline"));
  });
}


    // === STARTANIMATION RESPONSIVE ===
    window.addEventListener("load", () => {
      const intro = document.getElementById("intro-screen");
      const flyingLogo = intro?.querySelector("img");
      const headerLogo = document.querySelector(".join-logo");

      if (!intro || !flyingLogo || !headerLogo) {
        document.body.classList.add("loaded");
        return;
      }

      const isMobile = window.matchMedia("(max-width: 480px)").matches;

      if (isMobile) {
        // Mobile: Starte mit dunklem BG (schon im CSS), wei√ües Logo
        flyingLogo.src = "img/logo/join_logo_white.svg";
        flyingLogo.style.width = "150px";
        flyingLogo.style.transition = "opacity 0.3s ease";

        // Sanfter Fade-In
        flyingLogo.style.opacity = "0";
        setTimeout(() => (flyingLogo.style.opacity = "1"), 30);

        setTimeout(() => {
          // Fade Logo out f√ºr smoother Wechsel
          flyingLogo.style.opacity = "0";
          setTimeout(() => {
            // Wechsel zu normalem Logo + BG zu white (mit Transition)
            intro.style.backgroundColor = "white";
            flyingLogo.src = "img/logo/Logo for Favicon construction.svg";
            flyingLogo.style.opacity = "1";
            startFlyAnimation();
          }, 200); // K√ºrzere Wartezeit f√ºr Fade-Out
        }, 300); // Etwas l√§ngere Hold-Zeit f√ºr dunkles Logo
      } else {
        startFlyAnimation();
      }

      function startFlyAnimation() {
        const holdMs = 150;
        const flyMs = 1200;
        const easing = "cubic-bezier(0.7, 0, 0.3, 1)";
        intro.style.opacity = "1";

        setTimeout(() => {
          const startRect = flyingLogo.getBoundingClientRect();
          const endRect = headerLogo.getBoundingClientRect();

          const startCX = startRect.left + startRect.width / 2;
          const startCY = startRect.top + startRect.height / 2;
          const endCX = endRect.left + endRect.width / 2;
          const endCY = endRect.top + endRect.height / 2;

          const startW = startRect.width;
          const endW = endRect.width || 110;
          const scale = endW / startW;

          const dx = endCX - startCX;
          const dy = endCY - startCY;

          flyingLogo.style.transformOrigin = "center center";

          const anim = flyingLogo.animate(
            [
              { transform: "translate(0px, 0px) scale(1)" },
              { transform: `translate(${dx}px, ${dy}px) scale(${scale})` }
            ],
            { duration: flyMs, easing, fill: "forwards" }
          );

          anim.onfinish = () => {
            document.body.classList.add("loaded");
            intro.style.opacity = "0";
            setTimeout(() => intro.remove(), 800);
          };
        }, holdMs);
      }
    });
  </script>


  <!-- Firebase SDK (modular v10) -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signInAnonymously, RecaptchaVerifier, signInWithPhoneNumber, updateProfile } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-auth.js";
    import { getDatabase, ref, set } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-database.js";

    // Deine Firebase Config (jetzt eingebunden!)
    const firebaseConfig = {
      apiKey: "AIzaSyBI4JD0XBE-srOGHaLT81iUZ6meuOjgV8M",
      authDomain: "join-60a91.firebaseapp.com",
      databaseURL: "https://join-60a91-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "join-60a91",
      storageBucket: "join-60a91.firebasestorage.app",
      messagingSenderId: "1027472895369",
      appId: "1:1027472895369:web:254e2439fa85bc74d08558",
      measurementId: "G-K7ZPGG17YR"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getDatabase(app);

    // Exportiere f√ºr register.js
    window.firebaseAuth = auth;
    window.firebaseDb = db;
    window.createUserWithEmailAndPassword = createUserWithEmailAndPassword;
    window.signInWithEmailAndPassword = signInWithEmailAndPassword;
    window.signInAnonymously = signInAnonymously;
    window.RecaptchaVerifier = RecaptchaVerifier;
    window.signInWithPhoneNumber = signInWithPhoneNumber;
    window.updateProfile = updateProfile;
    window.ref = ref;
    window.set = set;
  </script>

  <script src="scripts/register.js"></script>

  <!-- üîî Notification Container -->
  <div id="notification-container"></div>

</body>

</html>